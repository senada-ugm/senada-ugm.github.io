{% assign collection = site.publications %}
{% assign item_id = publication.id %}
{% assign collection_name = "publications" %}
{% assign item_type = "publication" %}
{% assign slug = publication.id %}
{% include base/optional-item-link-prep.html %}

{% capture link_html %}
    <div><strong>{{ publication.title }}</strong></div>  
    <div class="mt-1">{{ publication.authors | join: ", " }}</div>
    <div class="mt-1">
      <i>{{ publication.journal }}</i>
      {{ publication.citation }}
      ({{ publication.year }})
    </div>
{% endcapture %}

<a id="{{ publication.id }}"></a>
<div class="card publication-card mb-3">
  <div class="card-body">
    {% include base/optional-item-link.html link_html=link_html %}

    <span class="float-right">{% include base/recent-news-link.html %}</span>
    
    <div class="mt-1">
      {% include base/publication-links.html %}
    </div>

    {% if page.layout == 'publications' %}
    {% capture link_html %} 
        <div class="mt-1 pl-4">{{ publication.abstract | truncatewords: site.max_words_card_long }}</div>
    {% endcapture %}
    {% include base/optional-item-link.html link_html=link_html %}
    
    <!-- Faculty Photos Section -->
    {% if publication.badges %}
      <div class="mt-3">
        <small class="text-muted">SENADA-UGM Faculty:</small>
        <div class="d-flex flex-wrap mt-1">
          {% for badge in publication.badges %}
            {% if badge contains 'person=' %}
              {% assign person_id = badge | remove: 'person=' %}
              {% for person in site.data.people %}
                {% if person.id == person_id and person.status == 'active' %}
                  <div class="faculty-photo-badge mr-2 mb-2" style="display: inline-block;">
                    <img src="{{ person.image | relative_url }}" 
                         alt="{{ person.name }}" 
                         class="rounded-circle"
                         style="width: 40px; height: 40px; object-fit: cover; border: 2px solid #2F65A7;"
                         title="{{ person.name }} - {{ person.description }}">
                    <div style="font-size: 0.7em; text-align: center; max-width: 44px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                      {{ person.name | split: ' ' | first }}
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
    {% endif %}  
  </div>

  {% if page.layout == 'publications' %}
    {% assign item = publication %}    
    {% include base/badges.html %}  
  {% endif %}  
</div>
