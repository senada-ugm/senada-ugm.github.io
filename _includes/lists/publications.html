<script>
document.addEventListener('DOMContentLoaded', function() {
    const yearFilter = document.getElementById('yearFilter');
    const authorFilter = document.getElementById('authorFilter');
    const keywordFilter = document.getElementById('keywordFilter');
    const clearFilters = document.getElementById('clearFilters');
    
    function filterPublications() {
        const selectedYear = yearFilter.value.trim();
        const selectedAuthor = authorFilter.value.trim();
        const keyword = keywordFilter.value.trim().toLowerCase();
        
        const publications = document.querySelectorAll('.publication-item');
        const yearHeaders = document.querySelectorAll('.year-group');
        
        // Hide all year headers first
        yearHeaders.forEach(header => {
            header.style.display = 'none';
        });
        
        let visibleYears = new Set();
        
        publications.forEach(pub => {
            const pubYear = pub.dataset.year;
            const pubAuthors = pub.dataset.authors;
            const pubKeywords = pub.dataset.keywords;
            
            let showPub = true;
            
            // Filter by year
            if (selectedYear && pubYear !== selectedYear) {
                showPub = false;
            }
            
            // Filter by author
            if (selectedAuthor && !pubAuthors.includes(selectedAuthor)) {
                showPub = false;
            }

            // Filter by keyword
            if (keyword && (!pubKeywords || !pubKeywords.includes(keyword))) {
                showPub = false;
            }
            
            if (showPub) {
                pub.style.display = 'block';
                visibleYears.add(pubYear);
            } else {
                pub.style.display = 'none';
            }
        });
        
        // Show year headers that have visible publications
        yearHeaders.forEach(header => {
            if (visibleYears.has(header.dataset.year)) {
                header.style.display = 'block';
            }
        });
    }
    
    yearFilter.addEventListener('change', filterPublications);
    authorFilter.addEventListener('change', filterPublications);
    keywordFilter.addEventListener('input', filterPublications);
    
    clearFilters.addEventListener('click', function() {
        yearFilter.value = '';
        authorFilter.value = '';
        keywordFilter.value = '';
        filterPublications();
    });
});
</script>
